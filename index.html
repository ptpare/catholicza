<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>catholicza</title>
 
  
  <!-- Move the meta tag with the CSP directive inside the head section -->
  <meta http-equiv="Content-Security-Policy" content="script-src 'unsafe-inline' 'unsafe-eval' 'self' *.bible.com *.youversion.com *.youversionapi.com *.youversionapistaging.com *.branch.io *.google.com *.google-analytics.com *.sharethis.com *.share-this.com *.typekit.net *.hotjar.com app.link.com *.googletagmanager.com *.polyfill.io cdn.ravenjs.com *.googleapis.com app.link https://js-agent.newrelic.com; img-src 'self'; style-src 'self' 'unsafe-inline'; object-src 'self' https://www.bible.com;">
  <!-- Add the origin 'https://js-agent.newrelic.com' to the script-src directive -->
  <!-- Remove the hash value for the script 'https://js-agent.newrelic.com/nr-spa-1.250.0.min.js' -->
  <!-- Remove the nonce value for the script 'https://js-agent.newrelic.com/nr-spa-1.250.0.min.js' -->
  <!-- Remove the 'strict-dynamic' keyword from the script-src directive -->
  <!-- Remove the hash value for the image 'sha256-9xJL7qZ6jyJlMfD4yDcDvjZoQ6wJusCkDT2KsauF0kI=' -->
  <!-- Remove the script-src-elem directive and rely on the script-src directive only -->
  
  <!-- Load the New Relic JavaScript agent with the defer attribute -->
  <script src="https://js-agent.newrelic.com/nr-spa-1.250.0.min.js" defer></script>
   </head>

<body>
<!-- Add a label element for the language drop down menu -->
<label for="language-picker-select">Choose your language:</label>
<!-- Add a select element with the options for the languages -->
<select name="language-picker-select" id="language-picker-select" style="padding: 10px;" }>
  <option value="256">Sepedi</option>
  <option value="3499">Afrikaans</option>
  <option value="2645">Português</option>
  <option value="1204">English</option>
  <option value="13">Arabic</option>
  <option value="15">Čeština / Czech</option>
  <option value="32">chiShona</option>
  <option value="33">Sevenska / Swedish</option>
  <option value="73">Deutsch</option>
  <option value="149">Español</option>
  <option value="106">Français</option>
  <option value="274">Sesotho</option>
  <option value="278">Setswana</option>
  <option value="282">isiXhosa</option>
  <option value="286">isiZulu</option>
  <option value="280">Tshivenda</option>
  <option value="328">Nederlands</option>
  <option value="393">Kiswahili</option>
  <option value="399">Filipino</option>
  <option value="418">XiTsonga</option>
  <option value="461">Noni (or Noone. Cameroon North West Province near Kumbo)</option>
  <option value="450">isiNdebele</option>
  <option value="472">Luvale</option>
  <option value="526">Magyar (Hungarian)</option>
  <option value="559">Acholi (Uganda)</option>
  <option value="604">Siswati</option>
  <option value="1068">Chichewa</option>
  <option value="1378">Chisena (Beira - Mozambique)</option>
  <option value="1444">Zimba</option>
  <option value="1810">Dholuo</option>
  <option value="3438">Myene</option>
  <option value="419">Bemba (Zambia)</option>
  <option value="3368">Italiano</option>
   <option value="2259">Ewe</option>
   <option value="825"> Lozi</option>
   <option value="3090"> Lunda</option>
   <option value="948"> chiTonga</option>
   <option value="1961"> Tumbaka</option>
   <option value="3614"> Nsenga</option>
   
  </select>

<!-- HTML TABLE 2024 Feb Week 3 -->
<table id="bible-table">
  <tr>
    <td></td>
    <td>1</td>
    <td>2</td>
    <td>3</td>
    <td>4</td>
    <td>5</td>
    <td>6</td>
    <td>7</td>
    <td>8</td>
    <td>9</td>
    <td>10</td>
  </tr>
  <tr>
    <td>Sunday February 18, First Sunday of Lent</td>
    <td>gen.9.8-15</td>
    <td>psa.25.4-5</td>
    <td>psa.25.6-7</td>
    <td>psa.25.8-9</td>
    <td>1pe.3.18-22</td>
    <td>mrk.1.12-15</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Monday, February 19</td>
    <td>lev.19.1-2</td>
    <td>lev.19.11-18</td>
    <td>psa.19.8</td>
    <td>psa.19.9</td>
    <td>psa.19.10</td>
    <td>psa.19.15</td>
    <td>mat.25.31-46</td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <!-- Add the remaining rows in a similar manner -->
  <tr>
    <td>Tuesday February 20</td>
    <td>isa.55.10-11</td>
    <td>psa.34.4-5</td>
    <td>psa.34.6-7</td>
    <td>psa.34.16-17</td>
    <td>psa.34.18-19</td>
    <td>mat.6.7-15</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Wednesday February 21, St Peter Damian</td>
    <td>jon.3.1-10</td>
    <td>psa.51.3-4</td>
    <td>psa.51.12-13</td>
    <td>psa.51.18-19</td>
    <td>luk.11.29-32</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Thursday February 22, Chair of Peter</td>
    <td>1pe.5.1-4</td>
    <td>psa.23.1-3a</td>
    <td>psa.23.4</td>
    <td>psa.23.5</td>
    <td>psa.23.6</td>
    <td>mat.16.13-19</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Friday February 23, Polycarp</td>
    <td>ezk.18.21-28</td>
    <td>psa.130.1-2</td>
    <td>psa.130.3-4</td>
    <td>psa.130.5-7a</td>
    <td>psa.130.7bc-8</td>
    <td>mat.5.20-26</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Saturday February 24</td>
    <td>dt.26.16-19</td>
    <td>psa.119.1-2</td>
    <td>psa.119.4-5</td>
    <td>psa.119.7-8</td>
    <td>mat.5.43-48</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Sunday February 25, Second Sunday of Lent</td>
    <td>gen.22.1-2</td>
    <td>gen.22.9</td>
    <td>gen.22.10-13</td>
    <td>gen.22.15-18</td>
    <td>psa.116.10</td>
    <td>psa.116.15</td>
    <td>psa.116.16-17</td>
    <td>psa.116.18-19</td>
    <td>rom.8.31-34</td>
    <td>mrk.9.2-10</td>
  </tr>
</table>

  
<!-- IFRAME ELEMENT -->
<!-- Add a cookie attribute to the iframe element -->
<iframe id="iframe" name="my-iframe" width="400" height="300" allow-forms allow-scripts cookie="same-site=None; Secure"></iframe>

<!-- JAVASCRIPT CODE -->
<script>
// Declare global variables
let ref = "PSA.23.1-6";
// let lang_code = "1204";
const iframe = document.getElementById("iframe");

// Get the reference to the select element by its id
const select = document.getElementById("language-picker-select");
// Get the value of the selected option
let lang_code = select.value;

// Click event listener for table cells
document.querySelectorAll("#bible-table td").forEach(cell => {
  cell.addEventListener("click", function () {
    ref = cell.innerText;
    // Use the fetch API instead of setting the iframe src attribute
    // Pass the mode: "cors" option to the fetch function
    // Add the "Origin" header to the request
    lang_code = document.getElementById("language-picker-select").value;
	// Include CORS : `https://cors-anywhere.herokuapp.com/`
	const url = `https://cors-anywhere.herokuapp.com/`+`https://www.bible.com/bible/${lang_code}/${ref}`;
	console.log("Passage Selector")
    console.log("reference: " , ref);
    console.log("language code: " , lang_code);
    console.log(url);
    fetch(url, {
      mode: "cors",
      headers: {
        "Origin": "https://example.com"
      }
    })
    .then(response => response.text())
    .then(data => {
      // Set the iframe content to the data
      iframe.contentWindow.document.open();
      iframe.contentWindow.document.write(data);
      iframe.contentWindow.document.close();
    })
    // Handle the possible rejections of the fetch promise
    .catch(error => {
      // Handle the error
      console.error(error);
      // Display a message to the user
      alert("Sorry, something went wrong. Please try again later.");
    });
  });
});

// Event listener for language picker select
document.getElementById("language-picker-select").addEventListener("change", function() {
  lang_code = this.value;
  // Use the fetch API instead of setting the iframe src attribute
  // Pass the mode: "cors" option to the fetch function
  // Add the "Origin" header to the request
 // Include CORS : `https://cors-anywhere.herokuapp.com/`
  const url = `https://cors-anywhere.herokuapp.com/`+`https://www.bible.com/bible/${lang_code}/${ref}`;
  console.log("language picker")
  console.log("reference: " , ref);
  console.log("language code: " , lang_code);
  console.log(url);
  fetch(url, {
    mode: "cors",
    headers: {
      "Origin": "https://example.com"
    }
  })
  .then(response => response.text())
  .then(data => {
    // Set the iframe content to the data
    iframe.contentWindow.document.open();
    iframe.contentWindow.document.write(data);
    iframe.contentWindow.document.close();
  })
  // Handle the possible rejections of the fetch promise
  .catch(error => {
    // Handle the error
    console.error(error);
    // Display a message to the user
    alert("Sorry, something went wrong. Please try again later.");
  });
});
</script>

</body>
</html>
